<header class="fixed top-0 left-0 right-0 z-50 bg-header opacity-100 backdrop-blur-sm border-b border-brand">
    <div class="absolute inset-0 gradient-header opacity-90"></div>
    <nav class="relative z-10 px-6 py-4">
        <div class="flex items-center justify-between max-w-7xl mx-auto">
            <div class="flex items-center space-x-3">
                <div class="w-12 h-12 flex-center bg-brand rounded-lg">
                    <img src="assets/icons/mask.png" alt="Máscara" class="w-full h-full p-2 filter-invert">
                </div>
                <h1 class="text-2xl font-bold metal-text text-brand">Mollerussa Metal Fest</h1>
            </div>

            <div class="hidden md:flex items-center space-x-8">
                <button (click)="volverAInicio()"
                    class="flex items-center text-secondary hover-text-brand transition-colors font-medium">
                    <i class="ri-arrow-left-line mr-2"></i>
                    {{ 'FORM_DINAR.VOLVER_INICIO' | translate }}
                </button>
            </div>

            <button (click)="volverAInicio()" class="md:hidden w-8 h-8 flex-center text-primary">
                <i class="ri-arrow-left-line mr-2"></i>
            </button>
        </div>
    </nav>
</header>

<section class="min-h-screen bg-page py-12">
    <div class="max-w-4xl mx-auto px-6">
        <!-- Botón volver -->
        <div class="mb-8">
            <button (click)="volverAInicio()"
                class="flex items-center text-brand hover-text-brand font-medium transition-colors">
                <i class="ri-arrow-left-line mr-2"></i>
                {{ 'FORM_DINAR.VOLVER_INICIO' | translate }}
            </button>
        </div>

        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-black metal-text text-brand mb-4">{{ 'FORM_DINAR.TITULO' | translate }}</h1>
            <p class="text-xl text-muted max-w-2xl mx-auto">
                {{ 'FORM_DINAR.SUBTITULO' | translate }}
            </p>
        </div>

        <!-- Descripción del evento -->
        <div class="bg-card border-2 border-brand rounded-lg p-8 mb-8 glow-effect">
            <h2 class="text-2xl font-bold text-brand mb-4">🎸 {{ 'FORM_DINAR.SOBRE_EVENTO' | translate }}</h2>
            <div class="space-y-4 text-secondary">
                <p [innerHTML]="'FORM_DINAR.DESCRIPCION_EVENTO_1' | translate"></p>
                <p [innerHTML]="'FORM_DINAR.DESCRIPCION_EVENTO_2' | translate"></p>
                <p>
                    <strong>{{ 'FORM_DINAR.LUGAR' | translate }}:</strong> Por determinar<br>
                    <strong>{{ 'FORM_DINAR.FECHA' | translate }}:</strong> Por determinar<br>
                    <strong>{{ 'FORM_DINAR.ACTUACIONES' | translate }}:</strong> Grupos de metal locales en directo
                </p>
                <p class="text-brand font-semibold">
                    {{ 'FORM_DINAR.EXPERIENCIA_UNICA' | translate }}
                </p>
            </div>
        </div>

        <!-- Formulario -->
        <div class="bg-card border-2 border-brand rounded-lg p-8 glow-effect">
            <form (ngSubmit)="onSubmit()" class="space-y-8">

                <!-- Información Personal -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-primary font-bold mb-3">{{ 'FORM_DINAR.NOMBRE' | translate }} *</label>
                        <input type="text" [(ngModel)]="formData.nombre" name="nombre"
                            class="w-full bg-page border-2 border-custom rounded-lg px-4 py-4 text-primary focus:border-brand focus:ring-2 focus:ring-brand outline-none transition-all"
                            [class.border-brand]="isFieldInvalid('nombre')">
                        <div *ngIf="isFieldInvalid('nombre')" class="text-red-400 text-sm mt-1 flex items-center">
                            <i class="ri-error-warning-line mr-1"></i>
                            {{ 'ERRORES.CAMPO_OBLIGATORIO' | translate }}
                        </div>
                    </div>
                    <div>
                        <label class="block text-primary font-bold mb-3">{{ 'FORM_DINAR.APELLIDOS' | translate }} *</label>
                        <input type="text" [(ngModel)]="formData.apellidos" name="apellidos"
                            class="w-full bg-page border-2 border-custom rounded-lg px-4 py-4 text-primary focus:border-brand focus:ring-2 focus:ring-brand outline-none transition-all"
                            [class.border-brand]="isFieldInvalid('apellidos')">
                        <div *ngIf="isFieldInvalid('apellidos')" class="text-red-400 text-sm mt-1 flex items-center">
                            <i class="ri-error-warning-line mr-1"></i>
                            {{ 'ERRORES.CAMPO_OBLIGATORIO' | translate }}
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-primary font-bold mb-3">{{ 'FORM_DINAR.DNI' | translate }} *</label>
                        <input type="text" [(ngModel)]="formData.dni" name="dni"
                            class="w-full bg-page border-2 border-custom rounded-lg px-4 py-4 text-primary focus:border-brand focus:ring-2 focus:ring-brand outline-none transition-all"
                            [class.border-brand]="isFieldInvalid('dni')">
                        <div *ngIf="isFieldInvalid('dni')" class="text-red-400 text-sm mt-1 flex items-center">
                            <i class="ri-error-warning-line mr-1"></i>
                            {{ 'ERRORES.CAMPO_OBLIGATORIO' | translate }}
                        </div>
                    </div>
                    <div>
                        <label class="block text-primary font-bold mb-3">{{ 'FORM_DINAR.POBLACION' | translate }} *</label>
                        <input type="text" [(ngModel)]="formData.poblacion" name="poblacion"
                            class="w-full bg-page border-2 border-custom rounded-lg px-4 py-4 text-primary focus:border-brand focus:ring-2 focus:ring-brand outline-none transition-all"
                            [class.border-brand]="isFieldInvalid('poblacion')">
                        <div *ngIf="isFieldInvalid('poblacion')" class="text-red-400 text-sm mt-1 flex items-center">
                            <i class="ri-error-warning-line mr-1"></i>
                            {{ 'ERRORES.CAMPO_OBLIGATORIO' | translate }}
                        </div>
                    </div>
                </div>

                <!-- Personas -->
                <div class="border-2 border-custom rounded-lg p-6">
                    <h3 class="text-xl font-bold text-brand mb-4">👥 {{ 'FORM_DINAR.PERSONAS' | translate }}</h3>

                    <div class="mb-6">
                        <label class="block text-primary font-bold mb-3">{{ 'FORM_DINAR.NUMERO_PERSONAS' | translate }} *</label>
                        <input type="number" [(ngModel)]="formData.numPersonas" name="numPersonas" min="0"
                            class="w-32 bg-page border-2 border-custom rounded-lg px-4 py-2 text-primary focus:border-brand focus:ring-2 focus:ring-brand outline-none transition-all"
                            (change)="calcularTotal()">
                        <div *ngIf="isFieldInvalid('numPersonas')" class="text-red-400 text-sm mt-1 flex items-center">
                            <i class="ri-error-warning-line mr-1"></i>
                            {{ 'ERRORES.CAMPO_OBLIGATORIO' | translate }}
                        </div>
                    </div>

                    <!-- Platos uno debajo del otro -->
                    <div class="space-y-6">
                        <!-- Plato Único 1 -->
                        <div class="bg-page border border-custom rounded-lg p-4">
                            <label class="block text-primary font-bold mb-2">{{ 'FORM_DINAR.PLATO_UNICO_1' | translate }} (10€)</label>
                            <p class="text-secondary text-sm mb-3">{{ 'FORM_DINAR.DESCRIPCION_PLATO_1' | translate }}</p>
                            <input type="number" [(ngModel)]="formData.plato1" name="plato1" min="0"
                                class="w-32 bg-page border-2 border-custom rounded-lg px-4 py-2 text-primary focus:border-brand focus:ring-2 focus:ring-brand outline-none transition-all"
                                (change)="calcularTotal()">
                        </div>

                        <!-- Plato Único Vegetariano -->
                        <div class="bg-page border border-custom rounded-lg p-4">
                            <label class="block text-primary font-bold mb-2">{{ 'FORM_DINAR.PLATO_VEGETARIANO' | translate }} (10€)</label>
                            <p class="text-secondary text-sm mb-3">{{ 'FORM_DINAR.DESCRIPCION_PLATO_VEGETARIANO' | translate }}</p>
                            <input type="number" [(ngModel)]="formData.platoVegetariano" name="platoVegetariano" min="0"
                                class="w-32 bg-page border-2 border-custom rounded-lg px-4 py-2 text-primary focus:border-brand focus:ring-2 focus:ring-brand outline-none transition-all"
                                (change)="calcularTotal()">
                        </div>

                        <!-- Plato Único Celíacos -->
                        <div class="bg-page border border-custom rounded-lg p-4">
                            <label class="block text-primary font-bold mb-2">{{ 'FORM_DINAR.PLATO_CELIACOS' | translate }} (10€)</label>
                            <p class="text-secondary text-sm mb-3">{{ 'FORM_DINAR.DESCRIPCION_PLATO_CELIACOS' | translate }}</p>
                            <input type="number" [(ngModel)]="formData.platoCeliacos" name="platoCeliacos" min="0"
                                class="w-32 bg-page border-2 border-custom rounded-lg px-4 py-2 text-primary focus:border-brand focus:ring-2 focus:ring-brand outline-none transition-all"
                                (change)="calcularTotal()">
                        </div>

                        <!-- Plato Único Infantil -->
                        <div class="bg-page border border-custom rounded-lg p-4">
                            <label class="block text-primary font-bold mb-2">{{ 'FORM_DINAR.PLATO_INFANTIL' | translate }} (10€)</label>
                            <p class="text-secondary text-sm mb-3">{{ 'FORM_DINAR.DESCRIPCION_PLATO_INFANTIL' | translate }}</p>
                            <input type="number" [(ngModel)]="formData.platoInfantil" name="platoInfantil" min="0"
                                class="w-32 bg-page border-2 border-custom rounded-lg px-4 py-2 text-primary focus:border-brand focus:ring-2 focus:ring-brand outline-none transition-all"
                                (change)="calcularTotal()">
                        </div>
                    </div>
                </div>

                <!-- Donación para asociación de niños con cáncer -->
                <div class="border-2 border-pink-500 rounded-lg p-6 bg-pink-50/10 mb-6">
                    <label class="flex items-start cursor-pointer group">
                        <input type="checkbox" [ngModel]="formData.donacionCancer" name="donacionCancer"
                            class="mr-4 mt-1 text-pink-500 focus:ring-pink-500 transform scale-125"
                            (ngModelChange)="formData.donacionCancer = $event; calcularTotal()">
                        <div class="flex-1">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">🎗️</span>
                                <span class="text-xl font-bold text-pink-600">{{ 'FORM_DINAR.DONACION_TITULO' | translate }}</span>
                            </div>
                            <p class="text-pink-700 mt-2 text-lg font-medium">
                                {{ 'FORM_DINAR.DONACION_DESCRIPCION' | translate }}
                            </p>
                            <p class="text-pink-600 mt-1 text-sm">
                                {{ 'FORM_DINAR.DONACION_DETALLE' | translate }}
                            </p>
                        </div>
                    </label>
                </div>

                <!-- Total -->
                <div class="bg-brand border-2 border-brand rounded-lg p-6 text-center">
                    <h3 class="text-2xl font-black text-primary mb-2">{{ 'FORM_DINAR.TOTAL_PAGAR' | translate }}</h3>
                    <div class="text-4xl font-black text-primary">{{ total + donacion }} €</div>
                    <p class="text-primary mt-2">{{ 'FORM_DINAR.PRECIO_CALCULADO' | translate }}</p>
                </div>

                <!-- Avisos Legales -->
                <div class="space-y-4">
                    <!-- Términos y Condiciones -->
                    <div class="bg-page border-2 border-custom rounded-lg p-6"
                        [class.border-brand]="formSubmitted && !formData.aceptoTerminos">
                        <label class="flex items-start">
                            <input type="checkbox" [(ngModel)]="formData.aceptoTerminos" name="aceptoTerminos"
                                class="mr-4 mt-1 text-brand focus:ring-brand transform scale-125">
                            <span class="text-secondary text-sm leading-relaxed" [innerHTML]="'FORM_DINAR.TERMINOS_TEXTO' | translate">
                            </span>
                        </label>
                        <div *ngIf="formSubmitted && !formData.aceptoTerminos"
                            class="text-red-400 text-sm mt-2 flex items-center">
                            <i class="ri-error-warning-line mr-1"></i>
                            {{ 'ERRORES.ACEPTAR_TERMINOS' | translate }}
                        </div>
                    </div>

                    <!-- Política de Privacidad -->
                    <div class="bg-page border-2 border-custom rounded-lg p-6"
                        [class.border-brand]="formSubmitted && !formData.aceptoPoliticaPrivacidad">
                        <label class="flex items-start">
                            <input type="checkbox" [(ngModel)]="formData.aceptoPoliticaPrivacidad"
                                name="aceptoPoliticaPrivacidad"
                                class="mr-4 mt-1 text-brand focus:ring-brand transform scale-125">
                            <span class="text-secondary text-sm leading-relaxed">
                                <span [innerHTML]="'FORM_DINAR.POLITICA_TEXTO' | translate"></span>
                                <button type="button" (click)="openPoliticaPrivacidad()"
                                    class="text-brand hover-text-brand underline font-semibold transition-colors">
                                    {{ 'FORM_DINAR.POLITICA_PRIVACIDAD' | translate }}
                                </button>
                                <strong> {{ 'FORM_DINAR.POLITICA_CONSENTIMIENTO' | translate }}</strong> *
                            </span>
                        </label>
                        <div *ngIf="formSubmitted && !formData.aceptoPoliticaPrivacidad"
                            class="text-red-400 text-sm mt-2 flex items-center">
                            <i class="ri-error-warning-line mr-1"></i>
                            {{ 'ERRORES.ACEPTAR_POLITICA' | translate }}
                        </div>
                    </div>

                    <div class="flex flex-col sm:flex-row gap-4 pt-6">
                        <button type="submit" [disabled]="enviando"
                            class="w-full sm:flex-1 btn-brand py-4 sm:py-5 px-6 sm:px-8 rounded-lg text-base sm:text-lg flex items-center justify-center transform hover:scale-105">
                            <span *ngIf="!enviando">
                                <i class="ri-send-plane-line mr-2 sm:mr-3"></i>
                                {{ 'FORM_DINAR.ENVIAR_RESERVA' | translate }}
                            </span>
                            <span *ngIf="enviando">
                                <i class="ri-loader-4-line animate-spin mr-2 sm:mr-3"></i>
                                {{ 'FORM_DINAR.ENVIANDO' | translate }}
                            </span>
                        </button>
                        <button type="button" (click)="volverAInicio()"
                            class="w-full sm:flex-1 bg-card hover:bg-custom btn-outline-brand font-bold py-4 sm:py-5 px-6 sm:px-8 rounded-lg transition-all duration-200 text-base sm:text-lg">
                            <i class="ri-arrow-left-line mr-2"></i>
                            {{ 'FORM_DINAR.VOLVER_INICIO' | translate }}
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Política de Privacidad -->
    <div *ngIf="showPoliticaPrivacidad"
        class="fixed inset-0 bg-header z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-page border-2 border-brand rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <!-- Header -->
            <div class="bg-brand p-6 sticky top-0 z-10">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-black text-primary">🔒 {{ 'POLITICA_PRIVACIDAD.TITULO' | translate }}</h2>
                    <button (click)="closePoliticaPrivacidad()"
                        class="text-primary hover:text-secondary text-2xl transition-colors">
                        &times;
                    </button>
                </div>
                <p class="text-primary mt-2">{{ 'POLITICA_PRIVACIDAD.SUBTITULO' | translate }}</p>
            </div>

            <!-- Contenido -->
            <div class="p-8 space-y-8">
                <section>
                    <h3 class="text-xl font-bold text-brand mb-4">{{ 'POLITICA_PRIVACIDAD.FINALIDAD_TITULO' | translate }}</h3>
                    <div class="bg-card border border-custom rounded-lg p-6">
                        <p class="text-secondary">
                            {{ 'POLITICA_PRIVACIDAD.FINALIDAD_DESCRIPCION' | translate }}
                        </p>
                    </div>
                </section>

                <div class="flex justify-center pt-6">
                    <button (click)="closePoliticaPrivacidad()" class="btn-brand py-3 px-8 rounded-lg">
                        {{ 'POLITICA_PRIVACIDAD.CERRAR' | translate }}
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>
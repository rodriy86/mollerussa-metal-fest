<nav class="fixed top-0 left-0 right-0 z-50 px-6 py-4 gradient-header border-b border-brand">

  <div class="flex items-center justify-between max-w-7xl mx-auto">

    <!-- Logo -->
    <div class="flex items-center space-x-3 z-50">
      <div class="w-12 h-12 flex-center bg-brand rounded-lg">
        <img src="assets/icons/mask.png" alt="Máscara" class="w-full h-full p-2 filter-invert">
      </div>
      <h1 class="text-2xl font-bold metal-text text-brand">{{configGlobal.festival.nombreCompleto}}</h1>
    </div>
    <div *ngIf="authService.getCurrentUser()" class="user-info">
        <p class="welcome-text">
          <strong>{{ authService.getCurrentUser()?.name }}</strong>
        </p>
      </div>

    <!-- Menú Desktop -->
    <div class="hidden md:flex space-x-8 items-center">
      <!--<a (click)="scrollTo('Inicio')"
        class="cursor-pointer text-secondary hover-text-brand transition-colors font-medium">
        {{ 'HEADER.INICIO' | translate }}
      </a>-->
      <a (click)="scrollTo('noticias')"
        class="cursor-pointer text-secondary hover-text-brand transition-colors font-medium">
        {{ 'HEADER.NOTICIAS' | translate }}
      </a>
      <a (click)="scrollTo('Lineup')"
        class="cursor-pointer text-secondary hover-text-brand transition-colors font-medium"  *ngIf="configGlobal.tickets.habilitar || authService.isAdmin()">
        {{ 'HEADER.LINEUP' | translate }}
      </a>
      <a (click)="scrollTo('Informacion')"
        class="cursor-pointer text-secondary hover-text-brand transition-colors font-medium"  *ngIf="configGlobal.tickets.habilitar || authService.isAdmin()">
        {{ 'HEADER.INFORMACION' | translate }}
      </a>
      <a (click)="scrollTo('Ubicacion')"
        class="cursor-pointer text-secondary hover-text-brand transition-colors font-medium">
        {{ 'HEADER.UBICACION' | translate }}
      </a>
      <a (click)="scrollTo('contacto')"
        class="cursor-pointer text-secondary hover-text-brand transition-colors font-medium">
        {{ 'HEADER.CONTACTO' | translate }}
      </a>
      <a [routerLink]="['/detalle-galeria']"
        class="cursor-pointer text-secondary hover-text-brand transition-colors font-medium">
        {{ 'HEADER.GALERIA' | translate }}
      </a>

      <!-- Selector de Idiomas -->
      <div class="relative">
        <button (click)="toggleLanguageDropdown()"
          class="flex items-center gap-2 px-3 py-2 rounded-lg border border-brand bg-transparent hover:bg-white/10 transition-all duration-200"
          [attr.aria-label]="'HEADER.IDIOMA' | translate">
          
          <!-- BANDERA ESPAÑOLA -->
          <span *ngIf="currentLanguage.code === 'es'" 
                class="fi fi-es flag-size"></span>
          
          <!-- BANDERA CATALANA -->
          <span *ngIf="currentLanguage.code === 'ca'" 
                class="catalan-flag flag-size"></span>
          
          <!-- BANDERA INGLESA -->
          <span *ngIf="currentLanguage.code === 'en'" 
                class="fi fi-gb flag-size"></span>

          <i class="ri-arrow-down-s-line text-muted transition-transform duration-300 text-sm"
            [class.rotate-180]="isLanguageDropdownOpen"></i>
        </button>

        <!-- Lista desplegable -->
        <div
          class="absolute top-full right-0 mt-2 w-48 rounded-lg bg-page border border-brand shadow-custom backdrop-blur-sm transition-all duration-300 z-50"
          [class]="isLanguageDropdownOpen ? 'opacity-100 visible translate-y-0' : 'opacity-0 invisible -translate-y-2'">
          <div class="py-2">
            @for (language of availableLanguages; track language.code) {
            <button (click)="selectLanguage(language)"
              class="w-full flex items-center gap-3 px-4 py-3 text-sm transition-all duration-200 hover-bg-brand-dark"
              [class]="language.code === currentLanguage.code ? 'text-brand bg-card font-bold' : 'text-secondary'">
              
              <!-- BANDERA ESPAÑOLA -->
              <span *ngIf="language.code === 'es'" 
                    class="fi fi-es flag-size flex-shrink-0"></span>
              
              <!-- BANDERA CATALANA -->
              <span *ngIf="language.code === 'ca'" 
                    class="catalan-flag flag-size flex-shrink-0"></span>
              
              <!-- BANDERA INGLESA -->
              <span *ngIf="language.code === 'en'" 
                    class="fi fi-gb flag-size flex-shrink-0"></span>

              <span class="flex-1 text-left">{{ language.name }}</span>
            </button>
            }
          </div>
        </div>
      </div>
    </div>

    <!-- Botón Hamburguesa -->
    <button class="md:hidden w-8 h-8 flex-center text-primary z-50" (click)="toggleMenu()"
            [attr.aria-label]="'HEADER.MENU' | translate">
      <i class="ri-menu-line text-xl" *ngIf="!isMenuOpen"></i>
      <i class="ri-close-line text-xl" *ngIf="isMenuOpen"></i>
    </button>
  </div>

  <!-- Menú Móvil -->
  <div class="md:hidden fixed top-16 left-0 w-full h-[calc(100vh-64px)] bg-page z-50 overflow-y-auto" *ngIf="isMenuOpen">
    <div class="flex flex-col space-y-6 p-8">
      <!--<a (click)="scrollTo('Inicio'); toggleMenu();"
        class="cursor-pointer text-primary hover-text-brand transition-colors font-medium py-3 text-lg border-b border-custom">
        {{ 'HEADER.INICIO' | translate }}
      </a>-->
      <a (click)="scrollTo('noticias'); toggleMenu();"
        class="cursor-pointer text-primary hover-text-brand transition-colors font-medium py-3 text-lg border-b border-custom">
        {{ 'HEADER.NOTICIAS' | translate }}
      </a>
      <a (click)="scrollTo('Lineup'); toggleMenu();"
        class="cursor-pointer text-primary hover-text-brand transition-colors font-medium py-3 text-lg border-b border-custom"  *ngIf="configGlobal.tickets.habilitar || authService.isAdmin()">
        {{ 'HEADER.LINEUP' | translate }}
      </a>
      <a (click)="scrollTo('Informacion'); toggleMenu();"
        class="cursor-pointer text-primary hover-text-brand transition-colors font-medium py-3 text-lg border-b border-custom"  *ngIf="configGlobal.tickets.habilitar || authService.isAdmin()">
        {{ 'HEADER.INFORMACION' | translate }}
      </a>
      <a (click)="scrollTo('Ubicacion'); toggleMenu();"
        class="cursor-pointer text-primary hover-text-brand transition-colors font-medium py-3 text-lg border-b border-custom">
        {{ 'HEADER.UBICACION' | translate }}
      </a>
      <a (click)="scrollTo('contacto'); toggleMenu();"
        class="cursor-pointer text-primary hover-text-brand transition-colors font-medium py-3 text-lg border-b border-custom">
        {{ 'HEADER.CONTACTO' | translate }}
      </a>
      <a (click)="toggleMenu();" [routerLink]="['/detalle-galeria']"
        class="cursor-pointer text-primary hover-text-brand transition-colors font-medium py-3 text-lg border-b border-custom">
        {{ 'HEADER.GALERIA' | translate }}
      </a>

      <!-- Selector de Idiomas Móvil -->
      <div class="pt-6 border-t border-custom">
        <div class="text-muted text-sm mb-3">{{ 'HEADER.IDIOMA' | translate }}</div>
        <div class="grid grid-cols-2 gap-2">
          @for (language of availableLanguages; track language.code) {
          <button (click)="selectLanguage(language); toggleMenu();"
            class="flex items-center gap-2 px-3 py-2 rounded-lg border border-brand transition-all duration-200 text-sm"
            [class]="language.code === currentLanguage.code ? 'bg-card text-brand font-bold' : 'bg-page text-secondary hover:bg-card'">
            <!-- BANDERA EN MÓVIL -->
            <span *ngIf="language.code === 'es'" class="fi fi-es flag-size"></span>
            <span *ngIf="language.code === 'ca'" class="catalan-flag flag-size"></span>
            <span *ngIf="language.code === 'en'" class="fi fi-gb flag-size"></span>
            <span>{{ language.code.toUpperCase() }}</span>
          </button>
          }
        </div>
      </div>
    </div>
  </div>
</nav>